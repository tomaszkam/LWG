<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE issue SYSTEM "lwg-issue.dtd">

<issue num="4520" status="LEWG">
<title>Breaking change in `std::span` new `initializer_list` constructor</title>
<section><sref ref="[span.cons]"/></section>
<submitter>Michael Schellenberger Costa</submitter>
<date>10 Feb 2026</date>
<priority>1</priority>

<discussion>
<p>
NVIDIA C++ standard library libcu++ received a <a href="https://github.com/NVIDIA/cccl/issues/7619">bug report</a> 
against our `span` implementation.
<p/>
However, looking into this a bit it seems that this is a source-breaking change from the new C++26 `initializer_list` 
constructor of `span` in conjunction with a bad conversion sequence.
<p/>
The <a href="https://godbolt.org/z/1PKExG8Yv">code in question</a> is: 
</p>
<blockquote><pre>
#include &lt;span&gt;

int main() {
  bool data[4] = {true, false, true, false};
  bool* ptr = data;
  size_t size = 4;

  ::std::span&lt;const bool&gt; bad_span{ptr, size};

  return 0;
}
</pre></blockquote>
<p>
The issue is that the compiler tries a conversion sequence from `bool*` to `bool` and 
`size_t` to `bool`.
<p/>
We probably should disallow conversions to `bool` by that constructor.
</p>

<note>2026-02-27; Reflector poll.</note>
<p>
Set priority to 1 after reflector poll.
</p>
<p>
Votes being split between LEWG/P1 and considering this new information from
deployment experience, and NAD as the breakage in the paper was already covered
in <sref ref="[diff.cpp23.containers]"/>. It was pointed out, that in contrast
to the silent change of meaning already discussed with paper, this snippet becomes
ill-formed.
</p>
</discussion>

<resolution>
</resolution>

</issue>
